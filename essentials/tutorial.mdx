---
title: Complete Interactive Places Map with 3D Globe
description: "Build a comprehensive Mapbox-powered places management app where creators can add locations and customers can explore them on a beautiful 3D globe. Learn Whop API integration, access control, and map interaction patterns."
---

# Complete Interactive Places Map Tutorial

## What You'll Build

You'll create a sophisticated places management application that combines:
- **3D Globe Visualization**: Interactive Mapbox globe with custom pin markers
- **Whop Integration**: User authentication and role-based access control
- **Real-time Database**: PostgreSQL with Prisma ORM for place management
- **Admin Features**: Add/delete places with geocoding support
- **Customer Experience**: Beautiful read-only map exploration

## Understanding Whop: A Quick Primer

**Whop** is a platform for creators to sell digital products and experiences. Think of it like Shopify but for digital creators (courses, communities, software access, etc.).

### Key Whop Concepts:

1. **Experience**: A digital product/service that customers can purchase access to
2. **Companies (Biz)**: Creator businesses that sell experiences  
3. **Access Levels**: Different permission levels for users:
   - `admin`: Full control (usually the creator)
   - `customer`: Paid access to view/use the experience
   - `no_access`: No permission to view

### How This App Fits In:

Your places map is an **Experience** that creators can sell. Customers pay to access the interactive map, while creators (admins) can manage the places shown on it.

## 1. Set up your Next.js project

Clone our Next.js app template that includes Whop authentication:

```bash
npx create-next-app@latest places-map-app -e https://github.com/whopio/whop-nextjs-app-template
```

```bash
cd places-map-app
```

Install dependencies:

<CodeGroup>
```bash pnpm
pnpm i
```

```bash npm
npm i
```

```bash yarn
yarn i
```
</CodeGroup>

Run the app locally:

<CodeGroup>
```bash pnpm
pnpm dev
```

```bash npm
npm run dev
```

```bash yarn
yarn dev
```
</CodeGroup>

Open http://localhost:3000 and follow the setup instructions.

## 2. Configure Your Whop App

### Create Your Whop App

1. Go to [Whop Developer Dashboard](https://developers.whop.com)
2. Create a new app
3. Set the redirect URL to `http://localhost:3000/api/auth/callback/whop`
4. Copy your App ID and API Key

### Environment Variables

Add these to your `.env.local`:

```env .env.local
# Whop Configuration
WHOP_APP_ID=app_your_app_id_here
WHOP_API_KEY=whop_your_api_key_here  
MY_USER_ID=your_whop_user_id

# Database (we'll set this up next)
DATABASE_URL="postgresql://..."
DIRECT_URL="postgresql://..."

# Mapbox (we'll get this later)
NEXT_PUBLIC_MAPBOX_TOKEN=pk.your_mapbox_token
```

**Important**: Install your app into your Whop business and switch to localhost mode for development.

## 3. Database Setup with Prisma

### Create Supabase Database

1. Go to [Supabase](https://supabase.com) and create a new project
2. Copy your database password
3. Go to Settings → Database → Connection pooling
4. Copy both connection strings (pooled and direct)

### Install Prisma

<CodeGroup>
```bash pnpm
pnpm add prisma @prisma/client
pnpm prisma init
```

```bash npm
npm install prisma @prisma/client
npx prisma init
```

```bash yarn
yarn add prisma @prisma/client
yarn prisma init
```
</CodeGroup>

### Database Schema

Create `prisma/schema.prisma`:

```prisma prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

// Represents a Whop Experience (the product customers buy)
model Experience {
  id         String  @unique  // Whop Experience ID
  title      String           // Experience name from Whop
  webhookUrl String          // Optional webhook for notifications
  bizName    String          // Creator's business name
  bizId      String          // Whop business ID
  places     Place[]         // All places in this experience
}

// Individual places that appear on the map
model Place {
  id           String     @id @default(cuid())
  name         String                    // Display name
  description  String?                   // Optional description
  latitude     Float                     // GPS coordinates
  longitude    Float
  address      String?                   // Human-readable address
  category     String?                   // Optional grouping
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @updatedAt
  experience   Experience @relation(fields: [experienceId], references: [id], onDelete: Cascade)
  experienceId String                    // Links to parent experience
}
```

### Database Operations

Update your `package.json` scripts:

```json package.json
{
  "scripts": {
    "prisma:generate": "prisma generate",
    "prisma:db:push": "prisma db push",
    "prisma:studio": "prisma studio"
  }
}
```

Generate and push schema:

<CodeGroup>
```bash pnpm
pnpm prisma:generate
pnpm prisma:db:push
```

```bash npm
npm run prisma:generate
npm run prisma:db:push
```

```bash yarn
yarn prisma:generate
yarn prisma:db:push
```
</CodeGroup>

## 4. Whop API Integration

### Understanding the Whop SDK

Create `lib/whop-api.ts`:

```typescript lib/whop-api.ts
import { WhopServerSdk, makeUserTokenVerifier } from "@whop/api";

// Main SDK instance for server-side API calls
export const whopApi = WhopServerSdk({
  // Your app's API key - required for all requests
  appApiKey: process.env.WHOP_API_KEY ?? "fallback",
  
  // Optional: User to make requests on behalf of
  // Usually your own user ID for app-level operations
  onBehalfOfUserId: process.env.MY_USER_ID,
  
  // Optional: Default company for business-related queries
  companyId: "biz_fsyAlxa8BZM1Ca", // Replace with your biz ID
});

// Token verifier for authenticating incoming requests
// This validates that requests come from legitimate Whop users
export const verifyUserToken = makeUserTokenVerifier({
  appId: process.env.WHOP_APP_ID ?? "fallback",
  dontThrow: true, // Return null instead of throwing on invalid tokens
});
```

**Key Concepts:**

- **App API Key**: Authenticates your app to Whop's API
- **User Token**: Proves a specific user is making the request
- **Experience Access**: Whop manages who can access what experiences

### Database Helper Functions

Create `lib/helpers.ts`:

```typescript lib/helpers.ts
import { whopApi } from "./whop-api";
import { PrismaClient } from "@prisma/client";

const prisma = new PrismaClient();

/**
 * Syncs a Whop Experience with our local database
 * This ensures we have the latest experience details
 */
export async function findOrCreateExperience(experienceId: string) {
  // Fetch current experience data from Whop
  const whopExperience = await whopApi.GetExperience({ experienceId });
  const experienceName = whopExperience.experience.name;
  const bizName = whopExperience.experience.company.title;
  const bizId = whopExperience.experience.company.id;

  // Check if we already have this experience in our database
  let experience = await prisma.experience.findUnique({
    where: { id: experienceId },
    include: { places: true }, // Include all places for this experience
  });

  if (!experience) {
    // First time setup - create new experience record
    experience = await prisma.experience.create({
      data: {
        id: experienceId,
        title: experienceName,
        bizName,
        bizId,
        webhookUrl: "", // Can be configured later
      },
      include: { places: true },
    });
    
    // Optional: Send notification about new installation
    sendWhopWebhook({
      content: "Someone installed the map places app in their whop!",
    });
  } else {
    // Update existing experience with latest Whop data
    experience = await prisma.experience.update({
      where: { id: experienceId },
      data: { title: experienceName, bizName, bizId },
      include: { places: true },
    });
  }
  
  return experience;
}

/**
 * Creates a new place in the database
 * Only admins should be able to call this
 */
export async function createPlace({
  experienceId,
  name,
  description,
  latitude,
  longitude,
  address,
  category,
}: {
  experienceId: string;
  name: string;
  description?: string;
  latitude: number;
  longitude: number;
  address?: string;
  category?: string;
}) {
  return await prisma.place.create({
    data: {
      experienceId,
      name,
      description,
      latitude,
      longitude,
      address,
      category,
    },
  });
}

/**
 * Fetches all places for an experience
 * Both admins and customers can call this
 */
export async function getPlaces(experienceId: string) {
  return await prisma.place.findMany({
    where: { experienceId },
    orderBy: { createdAt: 'desc' },
  });
}

/**
 * Deletes a place from the database
 * Only admins should be able to call this
 */
export async function deletePlace(placeId: string) {
  return await prisma.place.delete({
    where: { id: placeId },
  });
}

// ... webhook helper function for notifications
export async function sendWhopWebhook({
  content,
  experienceId = "exp_QccW4l1rRJok5d", // Default experience
}: {
  content: string;
  experienceId?: string;
}) {
  const payload = { content };
  
  const experience = await prisma.experience.findUnique({
    where: { id: experienceId },
  });

  const webhookUrl = experience?.webhookUrl || process.env.DEFAULT_WEBHOOK_URL || "";

  if (!webhookUrl || webhookUrl.trim() === "") {
    console.log("No webhook URL configured, skipping webhook");
    return;
  }

  try {
    const response = await fetch(webhookUrl, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload),
    });

    if (!response.ok) {
      console.error(`Webhook failed with status ${response.status}`);
    }
  } catch (error) {
    console.error("Error sending webhook:", error);
  }
}
```

## 5. Get Your Mapbox Token

1. Go to [Mapbox](https://mapbox.com) and create a free account
2. Navigate to your [Account page](https://account.mapbox.com/)
3. Copy your default public token (starts with `pk.`)
4. Add it to your `.env.local`:

```env .env.local
NEXT_PUBLIC_MAPBOX_TOKEN=pk.your_mapbox_token_here
```

## 6. Install Map Dependencies

<CodeGroup>
```bash pnpm
pnpm add mapbox-gl @radix-ui/react-slot class-variance-authority clsx tailwind-merge lucide-react
```

```bash npm
npm install mapbox-gl @radix-ui/react-slot class-variance-authority clsx tailwind-merge lucide-react
```

```bash yarn
yarn add mapbox-gl @radix-ui/react-slot class-variance-authority clsx tailwind-merge lucide-react
```
</CodeGroup>

Add Shadcn button component:

<CodeGroup>
```bash pnpm
pnpm dlx shadcn@latest add button
```

```bash npm
npx shadcn@latest add button
```

```bash yarn
yarn shadcn@latest add button
```
</CodeGroup>

## 7. Main Experience Page

Create `app/experiences/[experienceId]/page.tsx`:

```typescript app/experiences/[experienceId]/page.tsx
import { findOrCreateExperience } from "@/lib/helpers";
import { headers } from "next/headers";
import { whopApi, verifyUserToken } from "@/lib/whop-api";
import MapView from "@/components/MapView";

interface PageProps {
  params: Promise<{ experienceId: string }>;
}

export default async function ExperiencePage({ params }: PageProps) {
  const { experienceId } = await params;
  const headersList = await headers();
  
  // Verify the user token from the request headers
  // This ensures only legitimate Whop users can access the page
  const userToken = await verifyUserToken(headersList);

  if (!userToken) {
    return <div>Please log in to access this experience.</div>;
  }

  // Sync Whop experience data with our local database
  const experience = await findOrCreateExperience(experienceId);

  // Check if this specific user has access to this specific experience
  // This is where Whop's access control magic happens
  const hasAccess = await whopApi.CheckIfUserHasAccessToExperience({
    userId: userToken.userId,
    experienceId: experienceId,
  });

  if (!hasAccess.hasAccessToExperience.hasAccess) {
    return <div>You don't have access to this experience.</div>;
  }

  return (
    <div className="flex flex-col h-screen relative">
      {/* Info card showing experience details and user's access level */}
      <div className="absolute top-4 left-4 z-10 bg-white/95 backdrop-blur-md border border-white/20 rounded-lg px-3 py-2 shadow-lg max-w-xs">
        <h1 className="text-sm font-semibold text-gray-900 truncate">
          {experience.title}
        </h1>
        <p className="text-xs text-gray-600">
          {hasAccess.hasAccessToExperience.accessLevel === "admin" 
            ? "Admin access" 
            : "View Places"}
        </p>
      </div>

      <div className="flex-1">
        <MapView
          places={experience.places || []}
          accessLevel={hasAccess.hasAccessToExperience.accessLevel as "admin" | "customer" | "no_access"}
          experienceId={experienceId}
        />
      </div>
    </div>
  );
}
```

**Key Decisions Explained:**

1. **Server Component**: We use server-side rendering to securely verify user access before showing any content
2. **Token Verification**: `verifyUserToken()` ensures requests come from legitimate Whop users
3. **Access Check**: `CheckIfUserHasAccessToExperience()` determines what the user can see/do
4. **Database Sync**: `findOrCreateExperience()` keeps our local data in sync with Whop

## 8. TypeScript Definitions

Create `components/map/types.ts`:

```typescript components/map/types.ts
// Database model type - matches our Prisma schema
export interface Place {
  id: string;
  name: string;
  description?: string;
  category?: string;
  address?: string;
  latitude: number;
  longitude: number;
  createdAt: Date;
  updatedAt: Date;
  experienceId: string;
}

// For creating new places
export interface NewPlacePosition {
  lng: number;
  lat: number;
}

// Main component props
export interface MapViewProps {
  places: Place[];
  accessLevel: "admin" | "customer" | "no_access";
  experienceId: string;
}

// Mapbox geocoding API response
export interface GeocodingResult {
  features: Array<{
    place_name: string;
    center: [number, number];
  }>;
}
```

## 9. Map Utilities

Create `components/map/utils.ts`:

```typescript components/map/utils.ts
import type { GeocodingResult } from './types';

/**
 * Converts an address string into GPS coordinates using Mapbox Geocoding API
 * This allows users to add places by typing an address instead of clicking
 */
export const geocodeAddress = async (address: string): Promise<{
  lng: number;
  lat: number;
  fullAddress: string;
} | null> => {
  const mapboxToken = process.env.NEXT_PUBLIC_MAPBOX_TOKEN;
  if (!mapboxToken) return null;

  try {
    const response = await fetch(
      `https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(address)}.json?access_token=${mapboxToken}&limit=1`
    );
    
    const data: GeocodingResult = await response.json();
    
    if (data.features && data.features.length > 0) {
      const feature = data.features[0];
      return {
        lng: feature.center[0],
        lat: feature.center[1],
        fullAddress: feature.place_name,
      };
    }
    
    return null;
  } catch (error) {
    console.error('Geocoding error:', error);
    return null;
  }
};

/**
 * Checks if a point is currently visible in the map viewport
 * Useful for optimizing marker rendering
 */
export const isPointVisible = (map: any, point: [number, number]): boolean => {
  const bounds = map.getBounds();
  return bounds.contains(point);
};
```

## 10. Map Styling

Create `components/map/styles.ts`:

```typescript components/map/styles.ts
// Main map container styling for 3D globe effect
export const mapStyles = `
  .mapboxgl-map {
    position: absolute !important;
    top: 0 !important;
    bottom: 0 !important;
    left: 0 !important;
    right: 0 !important;
    width: 100% !important;
    height: 100% !important;
    background: rgb(12, 12, 35) !important; /* Space-like background */
  }
  
  .mapboxgl-canvas {
    position: absolute !important;
    width: 100% !important;
    height: 100% !important;
    outline: none !important;
    /* Subtle color adjustments for better visual appeal */
    filter: brightness(0.9) contrast(1.05) saturate(0.95) !important;
  }
  
  /* Hide default Mapbox controls - we'll create custom ones */
  .mapboxgl-control-container {
    display: none !important;
  }
  
  /* Custom popup styling for place details */
  .place-popup {
    background: rgba(255, 255, 255, 0.98) !important;
    backdrop-filter: blur(10px) !important;
    border-radius: 12px !important;
    padding: 0 !important;
    box-shadow: 0 4px 24px rgba(0, 0, 0, 0.15) !important;
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
    z-index: 999 !important;
    pointer-events: auto !important;
  }
  
  .place-popup .mapboxgl-popup-content {
    background: transparent !important;
    padding: 0 !important;
    border-radius: 12px !important;
    pointer-events: auto !important;
  }
  
  /* Remove default popup arrow */
  .place-popup .mapboxgl-popup-tip {
    display: none !important;
  }
  
  /* Place information display */
  .place-info {
    padding: 16px;
    min-width: 200px;
    pointer-events: auto;
    position: relative;
    z-index: 1000;
  }
  
  .place-info h3 {
    margin: 0 0 8px 0;
    color: #1a1a1a;
    font-size: 15px;
    font-weight: 600;
    letter-spacing: -0.2px;
  }
  
  .place-info .place-description {
    margin: 0 0 8px 0;
    color: #666;
    font-size: 13px;
  }
  
  .place-info .place-category {
    margin: 0 0 4px 0;
    color: #4f46e5;
    font-size: 12px;
    font-weight: 500;
  }
  
  .place-info .place-location {
    margin: 0 0 12px 0;
    color: #999;
    font-size: 12px;
  }
  
  /* Delete button for admin users */
  .delete-btn {
    background: #dc2626;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 12px;
    font-weight: 500;
    width: 100%;
    transition: background 0.2s ease;
    pointer-events: auto;
  }
  
  .delete-btn:hover {
    background: #b91c1c;
  }
  
  /* Custom marker pin styling */
  .custom-marker {
    width: 24px;
    height: 30px;
    cursor: pointer;
  }
  
  .custom-marker:hover {
    opacity: 0.8;
  }
`;

// Control panel styling for admin place management
export const controlPanelStyles = `
  .places-controls {
    position: absolute !important;
    bottom: 20px !important;
    left: 20px !important;
    background: rgba(255, 255, 255, 0.95) !important;
    backdrop-filter: blur(10px) !important;
    border-radius: 10px !important;
    padding: 12px !important;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12) !important;
    z-index: 1 !important;
    width: 240px !important;
    border: 1px solid rgba(255, 255, 255, 0.2) !important;
  }
  
  .control-button {
    background: white !important;
    border: 1px solid rgba(0, 0, 0, 0.1) !important;
    padding: 8px 12px !important;
    border-radius: 6px !important;
    cursor: pointer !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    width: 100% !important;
    font-weight: 500 !important;
    color: #1a1a1a !important;
    font-size: 12px !important;
    transition: all 0.2s ease !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05) !important;
    margin-bottom: 4px !important;
  }
  
  .control-button:hover {
    background: #f8f8f8 !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1) !important;
  }
  
  .control-button.active {
    background: #f0f0f0 !important;
    border-color: rgba(0, 0, 0, 0.15) !important;
    color: #000 !important;
  }
  
  .control-input {
    width: 100% !important;
    padding: 6px 8px !important;
    border: 1px solid rgba(0, 0, 0, 0.1) !important;
    border-radius: 4px !important;
    font-size: 11px !important;
    margin-bottom: 6px !important;
    background: white !important;
    box-sizing: border-box !important;
  }
  
  .control-input::placeholder {
    color: #999 !important;
  }
  
  .control-status {
    font-size: 10px !important;
    color: #10b981 !important;
    margin-bottom: 8px !important;
    text-align: center !important;
  }
  
  .control-actions {
    display: flex !important;
    gap: 6px !important;
    margin-top: 6px !important;
  }
`;
```

**Styling Decisions Explained:**

1. **Glass Morphism**: Semi-transparent backgrounds with blur for modern look
2. **Z-Index Management**: Ensures controls appear above the 3D globe
3. **Responsive Design**: Controls adapt to different screen sizes
4. **Accessibility**: Clear contrast ratios and hover states

## 11. API Routes

### Create Place API

Create `app/api/experiences/[experienceId]/places/route.ts`:

```typescript app/api/experiences/[experienceId]/places/route.ts
import { NextResponse } from "next/server";
import { verifyUserToken, whopApi } from "@/lib/whop-api";
import { headers } from "next/headers";
import { createPlace, getPlaces } from "@/lib/helpers";

/**
 * GET /api/experiences/[experienceId]/places
 * Fetches all places for an experience
 * Available to both admins and customers
 */
export async function GET(request: Request) {
  try {
    // Extract experience ID from URL
    const url = new URL(request.url);
    const match = url.pathname.match(/experiences\/([^/]+)\/places/);
    const experienceId = match ? match[1] : null;

    if (!experienceId) {
      return NextResponse.json(
        { error: "Missing experienceId" },
        { status: 400 }
      );
    }

    // Verify user authentication
    const headersList = await headers();
    const userToken = await verifyUserToken(headersList);
    if (!userToken) {
      return NextResponse.json({ error: "Unauthorized" }, { status: 401 });
    }

    // Check if user has access to this experience
    const hasAccess = await whopApi.CheckIfUserHasAccessToExperience({
      userId: userToken.userId,
      experienceId,
    });

    if (!hasAccess.hasAccessToExperience.hasAccess) {
      return NextResponse.json(
        { error: "Unauthorized, no access" },
        { status: 401 }
      );
    }

    // Fetch and return places
    const places = await getPlaces(experienceId);
    return NextResponse.json(places);
  } catch (error) {
    console.error("Error fetching places:", error);
    return NextResponse.json(
      { error: "Failed to fetch places" },
      { status: 500 }
    );
  }
}

/**
 * POST /api/experiences/[experienceId]/places
 * Creates a new place
 * Only available to admin users
 */
export async function POST(request: Request) {
  try {
    // Extract experience ID from URL
    const url = new URL(request.url);
    const match = url.pathname.match(/experiences\/([^/]+)\/places/);
    const experienceId = match ? match[1] : null;

    if (!experienceId) {
      return NextResponse.json(
        { error: "Missing experienceId" },
        { status: 400 }
      );
    }

    // Verify user authentication
    const headersList = await headers();
    const userToken = await verifyUserToken(headersList);
    if (!userToken) {
      return NextResponse.json({ error: "Unauthorized" }, { status: 401 });
    }

    // Check if user has ADMIN access (not just customer access)
    const hasAccess = await whopApi.CheckIfUserHasAccessToExperience({
      userId: userToken.userId,
      experienceId,
    });

    if (hasAccess.hasAccessToExperience.accessLevel !== "admin") {
      return NextResponse.json(
        { error: "Unauthorized, admin access required" },
        { status: 401 }
      );
    }

    // Parse request body
    const { name, description, latitude, longitude, address, category } =
      await request.json();

    // Validate required fields
    if (!name || typeof latitude !== "number" || typeof longitude !== "number") {
      return NextResponse.json(
        { error: "Name, latitude, and longitude are required" },
        { status: 400 }
      );
    }

    // Create the place
    const place = await createPlace({
      experienceId,
      name,
      description,
      latitude,
      longitude,
      address,
      category,
    });

    return NextResponse.json(place);
  } catch (error) {
    console.error("Error creating place:", error);
    return NextResponse.json(
      { error: "Failed to create place" },
      { status: 500 }
    );
  }
}
```

### Delete Place API

Create `app/api/experiences/[experienceId]/places/[placeId]/route.ts`:

```typescript app/api/experiences/[experienceId]/places/[placeId]/route.ts
import { NextResponse } from "next/server";
import { verifyUserToken, whopApi } from "@/lib/whop-api";
import { headers } from "next/headers";
import { deletePlace } from "@/lib/helpers";

/**
 * DELETE /api/experiences/[experienceId]/places/[placeId]
 * Deletes a specific place
 * Only available to admin users
 */
export async function DELETE(request: Request) {
  try {
    // Extract IDs from URL path
    const url = new URL(request.url);
    const pathMatch = url.pathname.match(/experiences\/([^/]+)\/places\/([^/]+)/);
    const experienceId = pathMatch ? pathMatch[1] : null;
    const placeId = pathMatch ? pathMatch[2] : null;

    if (!experienceId || !placeId) {
      return NextResponse.json(
        { error: "Missing experienceId or placeId" },
        { status: 400 }
      );
    }

    // Verify user authentication
    const headersList = await headers();
    const userToken = await verifyUserToken(headersList);
    if (!userToken) {
      return NextResponse.json({ error: "Unauthorized" }, { status: 401 });
    }

    // Ensure user has admin access
    const hasAccess = await whopApi.CheckIfUserHasAccessToExperience({
      userId: userToken.userId,
      experienceId,
    });

    if (hasAccess.hasAccessToExperience.accessLevel !== "admin") {
      return NextResponse.json(
        { error: "Unauthorized, admin access required" },
        { status: 401 }
      );
    }

    // Delete the place
    await deletePlace(placeId);
    return NextResponse.json({ success: true });
  } catch (error) {
    console.error("Error deleting place:", error);
    return NextResponse.json(
      { error: "Failed to delete place" },
      { status: 500 }
    );
  }
}
```

**API Design Decisions:**

1. **RESTful Structure**: Clear URL patterns that map to database operations
2. **Double Authentication**: Verify both user token AND experience access
3. **Role-Based Access**: Different permissions for admin vs customer
4. **Error Handling**: Comprehensive error responses with proper HTTP status codes
5. **Input Validation**: Ensure required fields are present and correctly typed

## 12. Continue with complete component implementation...

[Due to length constraints, I need to split this into multiple parts. Should I continue with the remaining components?]

## Key Architectural Decisions

### Why This Structure?

1. **Security First**: Every request validates both user identity and experience access
2. **Separation of Concerns**: Database logic, API logic, and UI logic are clearly separated
3. **Type Safety**: Full TypeScript coverage prevents runtime errors
4. **Scalability**: Modular component design allows easy feature additions
5. **User Experience**: Role-based UI adapts to user permissions

### Whop Integration Benefits

1. **Authentication**: No need to build user management from scratch
2. **Authorization**: Built-in access control for paid experiences
3. **Payment Processing**: Whop handles all billing and subscriptions
4. **User Management**: Automatic user roles and permissions

This architecture creates a robust, scalable foundation for your places map application while leveraging Whop's powerful creator economy features.
